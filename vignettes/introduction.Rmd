---
title: "An Introduction to ggResidpanel"
author: "Katherine Goode and Kathleen Rey"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{An Introduction to ggResidpanel}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>", fig.align = "center",
                      message = FALSE, fig.height = 4.5, fig.width = 6.5)
```

```{r echo = FALSE}
# Load libraries
library(dplyr)
library(ggplot2)
```

<img align="right" width="135" height="150" src="https://goodekat.github.io/ggResidpanel/images/gg_resid_sticker4.png">

ggResidpanel is an R package that was developed with the intention of providing an easier way to both create and view diagnostic plots for models. The graphics are created using ggplot2, and interactive versions of the plots are rendered using plotly. This vignette provides a brief introduction to ggResidpanel with information on how to install the package and several examples. To learn more about ggResidpanel, you can read through the ggResidpanel Tutorial and User Manual, which contains the details for all of the functions in the package and demonstrates how to use them.

## Installation

ggResidpanel can be installed from GitHub using the command below. (ggResidpanel is not available on CRAN yet)

```{r, eval = FALSE}
devtools::install_github("goodekat/ggResidpanel")
```

Load the ggResidpanel library.

```{r}
# Load the library
library(ggResidpanel)
```

## Penguin Example

The dataset `penguins` is included in ggResidpanel, which contains information from a study done on emperor penguins. Emperor penguins are able to dive under the water for long periods of time. The scientists who conducted the study were interested in understanding how the heart rate of the penguins relates to the depth and duration of the dives. The study involved attaching a device to penguins that recorded the heart rate of the bird during a dive.

The structure of the data is shown below. It has four variables.
  
- heart rate of the penguin (beats per minute)
- depth of the dive (meters)
- duration of the dive (minutes)
- bird identification number associated with the dive 

There are 125 observations in the data and 9 birds. Thus, there are multiple observations per penguin.

```{r}
str(penguins)
```

The code below show the number of observations per penguin. Penguin number 6 has the least number of observations with only 6, and penguin number 1 has the most observations with 20.

```{r}
table(penguins$bird)
```

```{r echo = FALSE}
penguins %>%
  mutate(bird = forcats::fct_recode(bird, 
                                    "Penguin 1" = "1", "Penguin 2" = "2",
                                    "Penguin 3" = "3", "Penguin 4" = "4", 
                                    "Penguin 5" = "5", "Penguin 6" = "6", 
                                    "Penguin 7" = "7", "Penguin 8" = "8", 
                                    "Penguin 9" = "9")) %>%
ggplot(aes(x = depth, y = heartrate, color = bird)) + 
  geom_point() + 
  facet_wrap( ~ bird) + 
  theme_bw() + 
  scale_color_manual(values = wesanderson::wes_palette("Zissou1", 9, 
                                                       type = "continuous")[1:9]) +
  labs(x = "Depth (m)", y = "Heart Rate (beats per minute)", color = "Penguin") + 
  theme(legend.position = "none")
```

```{r echo = FALSE}
penguins %>%
  mutate(bird = forcats::fct_recode(bird, 
                                    "Penguin 1" = "1", "Penguin 2" = "2",
                                    "Penguin 3" = "3", "Penguin 4" = "4", 
                                    "Penguin 5" = "5", "Penguin 6" = "6", 
                                    "Penguin 7" = "7", "Penguin 8" = "8", 
                                    "Penguin 9" = "9")) %>%
ggplot(aes(x = duration, y = heartrate, color = bird)) + 
  geom_point() + 
  facet_wrap( ~ bird) + 
  theme_bw() + 
  scale_color_manual(values = wesanderson::wes_palette("Zissou1", 9, 
                                                       type = "continuous")[1:9]) +
  labs(x = "Duration (min)", y = "Heart Rate (beats per minute)", color = "Penguin") + 
  theme(legend.position = "none")
```

```{r}
library(lme4)
m <- lmer(heartrate ~ duration + depth + (1|bird), data = penguins)
summary(m)
```

```{r}
resid_panel(m)
```

```{r}
resid_xpanel(m, yvar = "response")
```

```{r}
# m2 <- lm(log(Dive.Heart.Rate) ~ Duration.min. + Depth.m., data = penguins)
# summary(m2)
# resid_panel(m2)
# resid_xpanel(m2, yvar = "response")
# 
# m3 <- lm(Dive.Heart.Rate ~ Duration.min. + I((Duration.min.)^2) + Depth.m., data = penguins)
# summary(m3)
# resid_panel(m3)
# resid_xpanel(m3, yvar = "response")
# 
# m4 <- lm(log(Dive.Heart.Rate) ~ Duration.min. + I((Duration.min.)^2) + Depth.m., data = penguins)
# summary(m4)
# resid_panel(m4)
# resid_xpanel(m4, yvar = "response")
# 
# library(dplyr)
# 
# sub <- penguins %>%
#   group_by(Bird.) %>%
#   summarise_all(mean)
# 
# m5 <- lm(Dive.Heart.Rate ~ Duration.min. + Depth.m., data = sub)
# summary(m5)
# resid_panel(m5)
# resid_xpanel(m5, yvar = "response")
```

## Board Game Example


