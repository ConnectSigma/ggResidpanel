---
title: <span style="color:blue">ggResidpanel</span> User Manual
subtitle: "For Easy Creation of Panels of Diagnostic Plots"
author: "Katherine Goode and Kathleen Rey"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    df_print: paged
    toc: true
    toc_depth: 2
    toc_float: true
    theme: paper
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = 'center', cache = TRUE)
```

![](../images/gg_resid_sticker4.png){width=25%}

# Introduction to ggResidpanel

ggResidpanel provides a way to easily create and view diagnostic plots from models in R using ggplot2 graphics. The goal in creating the package was to allow a model to be passed to a function that returns a panel of diagnostic plots that can be viewed simultaneously. The panel allows the user to easily scan plots of interest to check for violations of model assumptions or lack of fit. The idea to portray the plots in a grid was motivated by the residual panel plots provided by SAS (version 9.4) procedures. In addition to being able to view the plots in a panel, ggResidpanel includes the ability to select which plots to include in the panel, ways to to adjust plot characteristics, and options to change the format of the figure. Furthermore, the package provides both static and interactive panels of plots and the ability to view diagnostic plots from multiple models in the same panel.

The package contains the following five functions. (Describe the model types accepted here.)

- [`resid_panel`](#resid_panel): Creates a panel of diagnostic plots of the residuals from a model (fit using a method currently accepted by the package)
- [`resid_interact`](#resid_interact): Creates an interactive panel of diagnostic plots of the residuals form a model (fit using a method currently accepted by the package)
- [`resid_xpanel`](#resid_xpanel): Creates a panel of diagnostic plots of the predictor variables (fit using a method currently accepted by the package)
- [`resid_compare`](#resid_compare): Creates a panel of diagnostic plots from multiple models (fit using a method currently accepted by the package)
- [`resid_auxpanel`](#resid_auxpanel): Creates a panel of diagnostic plots for model types not included in the package

A section is included below for each function with details describing how to use them. Their function will be demonstrated by fitting a model to the dataset `trees` included in R. The dataset contains information on the volume, girth, and height of 31 black cherry trees. The linear model below is fit to determine if their is a linear relationship between the volume of the tree given its height and girth.

```{r}
# Fit a linear model with a response variable of volume and predictor
# variables of height and girth
tree_model <- lm(Volume ~ Height + Girth, data = trees)
```

# Installation

The package is currently only available on GitHub. The intention is to add the package to CRAN in the near future. For now, the following code can be used to install ggResidpanel using the devtools package.

```{r eval = FALSE}
# Download and install ggResidpanel from GitHub
devtools::install_github("goodekat/ggResidpanel")
```

To use the package in R, load the library into your R session with the following code.

```{r}
# Load the library
library(ggResidpanel)
```

# <span style="color:blue">`resid_panel`</span> {#resid_panel}

## Overview

The function `resid_panel` takes a model and returns a panel of diagnostic plots. The currently accepted models are 

  - models fit using the `lm` or `glm` functions in base R (which will be referred to as "lm" and "glm" models) or 
  - models fit using the `lmer` or `glmer` functions from either the lme4 or lmerTest package (which will be referred to as "lmer", "glmer", and "lmerTest" models). 
  
The most basic use of this function is to only include the model in the function. The code below shows the figure that is created if the `tree_model` is input into `resid_panel` with no other options specified. This produces a panel with the four plots of a residual plot, a normal quantile plot, an index plot, and a histogram of the residuals.

```{r}
# Creates the default panel of plots based on the tree_model
resid_panel(tree_model)
```

The `plots` option in `resid_panel` allows the user to create a panel with a desired set of plots using the plots included in the package. There are three ways a user can do this:

- specify an [individual plot](#individual) to create one plot
- specify a [vector of plots](#vector) included in the package to create a panel including these plots
- specify a [package included panel](#prespecified) of plots

Explanations and examples for each of these methods are included in the next three sections.

## Individual Plots {#individual}

An individual plot can be created by including the option of `plots = "name of plot"` in the `resid_panel` function. The name of the plot must be in quotations. There are currently nine plots included in the package with `resid_panel`. Their names in the packages are as follows.

- [`boxplot`](#boxplot)
- [`cookd`](#cookd)
- [`hist`](#hist)
- [`index`](#index)
- [`lev`](#lev)
- [`ls`](#ls)
- [`qq`](#qq)
- [`resid`](#resid)
- [`yvp`](#yvp)

All plots are available to be used with "lm" and "glm" models, but `cookd`, `lev`, and `ls` are not available to be used with "lmer", "glmer", and "lmerTest" models. The details and examples of each plot are included below.

#### Boxplot of the Residuals {#boxplot}

The option of `plots = "boxplot"` creates a boxplot of the residuals. 

This can be used to visualize the distribution of the residuals from the model. It may help to identify outliers or determine if the distribution of the residuals is skewed.

```{r}
# Creates a boxplot of the residuals
resid_panel(tree_model, plots = "boxplot")
```

#### Cook's Distance Plot {#cookd}

The option of `plots = "cookd"` creates a plot of the Cook's distance values versus the observation numbers. The blue dashed horizontal line is placed at 4/n where n is the number of observations used to fit the model. This plot is only available for "lm" and "glm" models. 

This can be used to check for points with high leverage. Points above the dashed blue line are considered to be high leverage points, and points that have Cook's D values that are much larger than the rest are of particular interest.

```{r}
# Creates a Cook's D plot
resid_panel(tree_model, plots = "cookd")
```

#### Histogram of the Residuals {#hist}

The option of `plots = "hist"` creates a histogram of the residuals. The blue line is a normal density curve with a mean of zero and a standard deviation equal to the standard deviation of the residuals. 

`resid_panel` includes a `bins` option to specify the number of bins in the histogram. By default, `bins = 30` based on the default for the number of bins in the ggplot2 `geom_histogram` function.

This is another plot that can be used to visualize the distribution of the residuals. In particular, the normal density curve allows for the comparison of the residuals to a normal distribution.

```{r}
# Creates a histogram of the residuals
resid_panel(tree_model, plots = "hist")

# Creates the histogram with 20 bins
resid_panel(tree_model, plots = "hist", bins = 20)
```

#### Index Plot of the Residuals {#index}

The option of `plots = "index"` creates a plot of the residuals versus the observation numbers. A solid blue horizontal line through 0 is included for reference.

`residual_panel` includes a `smoother` indicator option. If set to `TRUE`, a loess smoother will included on the index plot. If set to `FALSE`, it will not be included. By default, `smoother = FALSE`. (This option also affects the `resid` plot.)

This can be used to look for patterns in the residuals in regards to the manner in which the data used to fit the model have been ordered. Often the data are ordered in a meaningful way such as time of observation. This plot can help to check if there is any relationship between the residuals and the order of the data. If a trend is found in this plot, it may suggest that a variable has been excluded from the model that would help to explain the variation in the response variable.

```{r}
# Creates an index plot of the residuals
resid_panel(tree_model, plots = "index")

# Creates the index plot with a smoother added
resid_panel(tree_model, plots = "index", smoother = TRUE)
```

#### Residuals vs. Leverage Plot {#lev}

The option of `plots = "lev"` creates a plot of the standardized residuals versus the leverage values. A loess curve is overlaid as a red solid line, and a horizontal line through 0 and a vertical line through 0 are included as black dashed lines. The red dashed lines are Cook's distance contour lines for Cook's D values of 0.5 and 1. This plot is only available for "lm" and "glm" models.

The Cook's D contour lines were obtained using the fact that Cook's distance can be computed as a function of the leverage and the standardized residual. For observation $i$, let $D_i$ represent the Cook's distance, $r_i$ represent the standardized residual, and $h_i$ represent the leverage value. Finally, let $p$ be the rank of the model. Then Cook's distance can be computed as
  $$D_i = \frac{r_i}{p}\left(\frac{h_i}{(1-h_i)^2}\right).$$
Thus, given a specified value of Cook's D ($D_i=0.5$ or $D_i=1$), a leverage value ($h_i$), and the rank of the model ($p$), it is possible to solve for the value of the standardized residual ($r_i$). The value of $D_i=1$ was chosen since a value of Cook's D larger than 1 is often considered to be a point with high leverage.

This plot can be used to look for trends in the residuals based on the leverage values and to identify points with high leverage. Points that fall outside of Cook's D contours lines may be of interest. Points that fall outside of the contour line with Cook's D set to 1 are considered to be high leverage points. As seen in the plot below, not all contour lines may appear when the plot is created depending on the leverage values of the data points. 

```{r}
# Creates a residuals vs. leverage plot
resid_panel(tree_model, plots = "lev")
```

#### Location-Scale Plot {#ls}

The option of `plots = "ls"` creates a location-scale plot of the residuals. It plots the square root of the absolute value of the standardized residuals on the y-axis and the predicted values on the x-axis. The predicted values are plotted on the original scale for "glm" and "glmer" models. A loess curve is overlaid as a red solid line. This plot is only available for "lm" and "glm" models. 

The location-scale plot can be used to check for patterns in the residuals in relationship to the predicted values. It can be used to check for homogeneity of the residuals by determining whether the residuals show equal spread along the range of the predicted values. In the idea situation, the loess curve would be a straight line with points evenly dispersed around it for the whole range of the predicted values.

```{r}
# Creates a location-scale plot of the residuals
resid_panel(tree_model, plots = "ls")
```

#### Normal Quantile Plot {#qq}

The option of `plots = "qq"` creates a normal quantile plot of residuals using the R package [qqplotr](https://cran.r-project.org/web/packages/qqplotr/index.html). The sample quantiles are plotted on the y-axis, and the theoretical normal quantiles are plotted on the x-axis. See the qqplotr documentation for details on the computation of the sample and theoretical quantiles. The blue line is a 1-1 line shown for reference. 

`resid_panel` includes two options to adjust the normal quantile plot based on options from the qqplotr package. The option of `qqline` indicates whether to include the 1-1 line on the qq-plot. By default, `qqline = TRUE`. The option of `qqbands` indicates whether to include 95% confidence bands on the qq-lot. By default, `qqbands = FALSE`.

This plot is meant to be used to check if the residuals approximately follow a normal distribution. If the points follow the 1-1 line, it suggests that the residuals are approximately normally distributed.

```{r}
# Creates a normal quantile plot of the residuals
resid_panel(tree_model, plots = "qq")

# Creates the qq-plot with the 1-1 line removed
resid_panel(tree_model, plots = "qq", qqline = FALSE)

# Creates the qq-plot with the confidence bands added
resid_panel(tree_model, plots = "qq", qqbands = TRUE)
```

#### Residual Plot {#resid}

The option of `plots = "resid"` creates a plot of the residuals versus the predicted values. The predicted values are plotted on the original scale for glm and glmer models. A solid blue horizontal line through 0 is included.

`residual_panel` includes a `smoother` indicator option. If set to `TRUE`, a loess smoother will included on the residual plot. If set to `FALSE`, it will not be included. By default, `smoother = FALSE`.

The residual plot can be used to check for homogeneity (constant variance) of the residuals and possible violations of the linear assumption. The assumption of homogeneity is met if the residuals are have approximately the same range throughout the entire range of the predicted values. The assumption of linearity may be violated if there is some trend in the residuals so that the residuals are not evenly distributed below and above 0 throughout the range of the predicted values. (This option also affects the `index` plot.)

```{r}
# Creates a residual plot
resid_panel(tree_model, plots = "resid")

# Creates the plot with the smoother added
resid_panel(tree_model, plots = "resid", smoother = TRUE)
```

#### Response vs. Predicted Plot {#yvp}

The option of `plots = "yvp"` creates a plot of the observed response variable values versus the predicted values from the model. Both response variable and predicted values are plotted on the original scale for "glm" and "glmer" models. The blue solid line is a 1-1 line, which is included for reference.

This plot provides a visualization to assess how similar the model predictions of the response variable are in relationship to the observed response variable values. The model is producing predictions similar to the observes values if the points follow the 1-1 line.

```{r}
# Creates a plot of observed values vs. fitted values
resid_panel(tree_model, plots = "yvp")
```

## User Specified Panels {#vector}

The `plots` option in `resid_panel` also allows the user to specify a vector of plots to include in a panel. To do this, the user can include an option of the form of `plots = c("name of plot 1", "name of plot 2", ...))` in the function. The names of the plots must be in quotations. Any of the individual plots listed in the previous section that are available for the model type can be included in the vector. Any number of plots greater than 0 can be included in the vector. If a plot name is included multiple times in the vector, a plot will be created for each instance the name is included. Some examples of user specified plots are included below.

```{r}
# Creates a panel with a user specified vector of two plot names
resid_panel(tree_model, plots = c("resid", "qq"))

# Creates a panel from a vector of four plot names
resid_panel(tree_model, plots = c("hist", "ls", "cookd", "lev"))

# An example to show what happens if a plot name is included multiple times in the vector
resid_panel(tree_model, plots = c("resid", "resid"))
```

## Package Specified Panels {#prespecified}

ggResidpanel includes prespecified panel options for `resid_panel` that the authors of the package thought users would find helpful. These can be used by including the option of `plots = "specified panel name"` in `resid_panel`. The four package included panel option are as follows.

- [`all`](#all)
- [`default`](#default)
- [`R`](#R)
- [`SAS`](#SAS)

The options of `all`, `default`, and `SAS` can be used for all model types, but the option of `R` can only be used for models of type "lm" or "glm". The details of these panels and examples of the code are included below.

#### Panel of All Plots {#all}

The option of `plots = "all"` creates a panel of all plots included in the package that are available for the model type input into `resid_panel`. Note that "cookd", "ls", and "lev" are not available for "lmer", "lmerTest", and "glmer" models.

```{r}
# Creates a panel of all plots available for an "lm" model
resid_panel(tree_model, plots = "all")
```

#### Default Panel {#default}

Unsurprisingly, the option of `plots = "default"` is the default panel displayed when `resid_panel` is applied to a model with no `plots` option specified. This creates a panel with a residual plot, a normal quantile plot of the residuals, an index plot of the residuals, and a histogram of the residuals.

```{r}
# Creates the default panel of plots
resid_panel(tree_model)

# Creates the default panel with the option explicitly specified
resid_panel(tree_model, plots = "default")
```

#### Base R Inspired Panel of Plots {#R}

The option of `plots = "R"` is designed to mimic the diagnostic plots created by applying the base R function `plot` to an "lm" or "glm" model. As a result, it can only be used with an "lm" or "glm" model. It creates a panel with a residual plot, a normal quantile plot of the residuals, a location-scale plot, and a residuals versus leverage plot.

```{r}
# Creates the R panel of plots with the smoother option for the residual plot set to TRUE
resid_panel(tree_model, plots = "R", smoother = TRUE)

# These are the lm diagnostic plots from base R which the "R" panel is designed to mimic
par(mfrow = c(2,2)) # Creates a 2x2 grid of plots
plot(tree_model)    # Creates the base R diagnostic plots
par(mfrow = c(1,1)) # Returns the settings to a 1x1 grid of plots
```

#### SAS Inspired Panel of Plots {#SAS}

The option of `plots = "SAS"` creates a panel with a residual plot, a normal quantile plot of the residuals, a histogram of the residuals, and a boxplot of the residuals. This was modeled after the residpanel option in proc mixed from SAS version 9.4.

```{r}
# Creates the SAS panel of plots
resid_panel(tree_model, plots = "SAS")
```

## Residual Types {#type}

The option of `type` in `resid_panel` adjusts the type of residuals to use in the plot. Several residual types are available to be requested based on the model type that is input into `resid_panel`. These are listed below. If a `type` is not specified, the default residual type for each model type is used. If a type other than raw residuals are used, the axis label for the axis that the residuals are plotted on will be specify the type of residual used. For example, if the raw residuals are used, the axis label will be "Residuals", but if Pearson residuals are used, the axis label will be "Pearson Residuals".

See the vignette on residuals to see the formulas used to compute the different residual types. (<span style="color:red">need to change the names of the document and add a link</span> )

#### Options for Residual `type`

"lm" model residual options:

- `pearson`: Pearson residuals
- `response`: raw residuals (default for "lm")
- `standardized`: standardized raw residuals

"glm" model residual options:

- `pearson`: Pearson residuals
- `deviance`: deviance residuals (default for "glm")
- `response`: raw residuals
- `stand.deviance`: standardized deviance residuals
- `stand.pearson`: standardized Pearson residuals

"lmer" and "lmerTest" model residual options:

- `pearson`: Pearson residuals (default for "lmer" and "lmerTest")
- `response`: raw residuals

"glmer" model residual options:

- `pearson`: Pearson residuals
- `deviance`: deviance residuals (default for "glmer")
- `response`: raw residuals

Note that the plots of `ls` and `lev` only accept standardized residuals.

```{r}
# Example requesting standardized residuals with a panel of plots from an lm model
resid_panel(tree_model, type = "standardized")
```

## Formatting Options {#format}

All of the functions in ggResidpanel have the following options for adjusting the format of the panel.

- [`axis.text.size`](#text.size) and [`title.text.size`](#text.size)
- [`nrow`](#nrow)
- [`scale`](#scale)
- [`theme`](#theme)
- [`title.opt`](#title.opt)

These details of how to use these options and examples of displaying the changes are shown below.

#### Plot Text Size {#text.size}

There are two options that can be used to adjust the text size in the panel. The option of `axis.text.size` specifies the size of the text for the axis labels. By default, `axis.text.size = 10`. The option of `title.text.size` specifies the size of the text for the titles. By default, `title.text.size = 12`. Both of these options adjust the text size in all of the plots in the panel.

```{r}
# Creates the default panel with larger text sizes for both the axis labels and the title
resid_panel(tree_model, axis.text.size = 14, title.text.size = 16)
```

#### Number of Rows in the Panel {#nrow}

The option of `nrow` allows the user to specify the number of rows in the panel. This works for both user and packages specified panels.

```{r fig.width = 12, fig.height = 4}
# Creates the default panel of four plots with all of the plots in a row instead of a 2x2 grid
resid_panel(tree_model, nrow = 1)
```

```{r fig.width = 3, out.width = '40%'}
# Creates a panel with a residual plot and a qq-plot with two rows 
resid_panel(tree_model, plots = c("resid", "qq"), nrow = 2)
```

#### Scale of Graph {#scale}

The option of `scale` adjust the size of the graphs in the panel. It takes values in the interval of (0,1]. The user may find this helpful if the some of the text from one graph overlaps another graph or if the graphs appear too close together in a panel.

```{r}
# Creates a panel of plots with the default scale
resid_panel(tree_model, plots = c("lev", "yvp", "ls", "cookd"))

# Creates the same panel of plots shown above with a scale of 0.9 
resid_panel(tree_model,  plots = c("lev", "yvp", "ls", "cookd"), scale = 0.9)
```

#### Panel Theme {#theme}

The option of `theme` adjusts the ggplot2 theme to be used when creating the plots. The current options available in ggResidpanel are "bw", "classic", and "grey" (or "gray"). The default is "bw". The theme is applied to all plots in the panel.

```{r}
# Creates the default panel with the classic theme
resid_panel(tree_model, theme = "classic")

# Creates the default panel with the grey theme
resid_panel(tree_model, theme = "grey")
```

#### Title Option {#title.opt}

The option of `title.opt` indicates whether or not to include a title on the plots in the panel. It can be set to TRUE or FALSE, and the default is set to TRUE.

```{r}
# Creates the default panel with the titles removed
resid_panel(tree_model, title.opt = FALSE)
```

# <span style="color:blue">`resid_interact`</span> {#resid_interact}

## Overview

The function `resid_interact` produces makes use of the plotly package to create interactive panels of diagnostic plots. The interactivity allows users to hover their cursor over points in the plots to easily access information about the points that is included in the dataset. This function was included with the intention of helping users identify outliers and points of interest.

`resid_interact` functions in a similar way to `resid_panel`. It has (mostly) the same input options, and it includes the same plots and prespecified panels. Similar to `resid_panel`, `resid_interact` currently requires a model of type "lm", "glm", "lmer", lmerTest, or glmer.

The most basic way to use `resid_interact` is to input a model into the function as seen below. It creates an interactive version of the default panel created by `resid_panel`. When the cursor is hovered over a point, a tooltip appears. The first two lines contain the $x$ and $y$ coordinates of the point. The remaining lines that appear after "Data:" are the observed values for the data point for all of the variables included in the model and the observation number. Different types of plots have slightly varying types of interactivity. All of the functionality is described below in the section on [individual plots](#interact_ind).

```{r}
# Creates an interactive version of the default panel from resid_panel
resid_interact(tree_model)
```

`resid_interact` offers the same three ways in a which a user can create a panel of plots:

- specify an [individual plot](#interact_ind) to create one plot
- specify a [vector of plots](#interact_vector) included in the package to create a panel including these plots
- specify a [package included panel](#interact_pre) of plots

Additional details on these methods are described in the next three sections.

## Individual Plots {#interact_ind}

In the same way an individual plot can be created in `resid_panel`, an individual interactive plot can be created in `resid_interact` by including the option of `plots = "name of plot"` in the `resid_interact` function. The name of the plot must be in quotations. The same nine plots included with `resid_panel` are included with `resid_interact`. Their names in the packages are as follows.

- [`boxplot`](#interact_boxplot)
- [`cookd`](#interact_cookd)
- [`hist`](#interact_hist)
- [`index`](#interact_index)
- [`lev`](#interact_lev)
- [`ls`](#interact_ls)
- [`qq`](#interact_qq)
- [`resid`](#interact_resid)
- [`yvp`](#interact_yvp)

Again, all plots are available to be used with "lm" and "glm" models, but `cookd`, `lev`, and `ls` are not available to be used with "lmer", "glmer", and "lmerTest" models. Instructional details for creating each of the plots are described below. For information on how the plots are created, return to the section on [individuals plots](#individual) in the `resid_panel` section.

#### Boxplot of the Residuals {#interact_boxplot}

The option `plots = "boxplot"` creates an interactive boxplot. If the cursor is hovered over the vertical line created by the whiskers in the plot, a tooltip appears at the location of each of the residual points. (Note that the points are not visible on the plot.) The tooltip first lists the value of the residual, and the remaining information lists the variables included in the model with the observed value and the observation number of the point. If the cursor is hovered anywhere else on the boxplot, tooltips will appear showing the location and value of the minimum, maximum, median, and first and third quantiles of the residuals.

```{r}
# Creates an interactive boxplot of the residuals
resid_interact(tree_model, plots = "boxplot")
```

#### Cook’s Distance Plot {#interact_cookd}

The option `plots = "cookd"` creates an interactive Cook's distance plot. When the cursor is hovered over a point, a tooltip is displayed. It first lists Cook's D value for that point, and then it lists the observed data values and observation number. This plot is only available for “lm” and “glm” models.

```{r}
# Creates an interactive Cook's D plot
resid_interact(tree_model, plots = "cookd")
```

#### Histogram of the Residuals {#interact_hist}

The option of `plots = "hist"` creates an interactive histogram of the residuals. The cursor can be hovered over the bars in the histogram to display a tooltip that lists the density value at the top of the bar and the number of observations in the bar ("count"). If the cursor is hovered over the bottom on the plot where the density equal to 0, a tooltip appears that shows the location of the data points and lists the observed value and observation number of the data point.

`resid_interact` includes the same `bins` option as `resid_panel` for the histogram. It allows the user to specify the number of bins to use when creating the histogram. Again, by default, `bins = 30`.

```{r}
# Creates an interactive histogram of the residuals
resid_interact(tree_model, plots = "hist")

# Creates the histogram with 20 bins
resid_interact(tree_model, plots = "hist", bins = 20)
```

#### Index Plot of the Residuals {#interact_index}

The option of `plots = "index"` creates an interactive index plot of the residuals. The cursor can be hovered over a data point to see a tooltip that containing the value of the residual, the observed variable values, and the observation number of the point.

`resid_interact` also includes the `smoother` option for the index plot which indicates whether or not to include a loess smoother on the index plot. Set `smoother = TRUE` to have the smoother appear. The default is `smoother = FALSE`. This option also affects the residual plot if included in the same panel.

```{r}
# Creates an interactive index plot of the residuals
resid_interact(tree_model, plots = "index")

# Creates the interactive index plot with a smoother added
resid_interact(tree_model, plots = "index", smoother = TRUE)
```

#### Residuals vs. Leverage Plot {#interact_lev}

The option `plots = "lev"` creates an interactive residual versus leverage plot. The cursor can be hovered over a data point to see a tooltip that contains the leverage, the standardized residual, the observed variable values, and the observation number of the data points. It is also possible to hover over the smoother line and the Cook's D contour lines to see the leverage and standardized residual values at that location on the line. This plot is only available for “lm” and “glm” models.

```{r}
# Creates an interactive residual vs. leverage plot
resid_interact(tree_model, plots = "lev")
```

#### Location-Scale Plot {#interact_ls}

The option `plots = "ls"` creates an interactive location-scale plot. The cursor can be hovered over a point to see a tooltip that contains the prediction, the square root of the absolute value of the standardized residual, the observed values of the variables in the model, and the observation number of the point. It is also possible to hover over the loess smoother to view the prediction and square root of the absolute value of the standardized residual at that location on the line. This plot is only available for “lm” and “glm” models.

```{r}
# Creates an interactive location-scale plot
resid_interact(tree_model, plots = "ls")
```

#### Normal Quantile Plot {#interact_qq}

The option `plots = "qq"` creates an interactive normal quantile plot. When the cursor is hovered over a point, a tooltip appears that displays the theoretical value, the residual value, the observed data values, and the observation number of the point.

`resid_interact` contains the same option of `qqline` that is included with `resid_panel`. It indicates whether to include a 1-1 line on the qq-plot. If TRUE is specified, the line is included. By default, `qqline = TRUE`. The option of `qqbands` that is included with `resid_panel` has not been implemented in plotly, so it is not available as an option with `resid_interact`.

```{r}
# Creates an interactive normal quantile plot
resid_interact(tree_model, plots = "qq")

# Creates a normal quantile plot with the 1-1 line removed
resid_interact(tree_model, plots = "qq", qqline = FALSE)
```

#### Residual Plot {#interact_resid}

The option of `plots = "resid"` creates an interactive residual plot. When the cursor is hovered over a point, a tooltip appears that contains the prediction, the residual, the observed variable values, and the observation number associated with the point.

`resid_interact` includes the option of `smoother` (just like `resid_panel`), which indicates whether or not to include a loess smoother on the residual plot. If set to TRUE, the smoother is included. By default `smoother = FALSE`. This option also affects the index plot if included in the same panel. 

```{r}
# Creates an interactive residual plot
resid_interact(tree_model, plots = "resid")

# Creates the residual plot with a smoother
resid_interact(tree_model, plots = "resid", smoother = TRUE)
```

#### Response vs. Predicted Plot {#interact_yvp}

The option of `plots = "yvp"` creates an interactive plot of the response variable versus the predicted value. If the cursor is hovered over a point, a tooltip appears that contains the predicted value, the response variable value, the observed variable values, and the observation number.

```{r}
# Creates an interactive residual vs. predicted value plot
resid_interact(tree_model, plots = "yvp")
```

## User Specified Panels {#interact_vector}

`resid_interact` allows for user specified panels. Just as with `resid_panel`, this can be done by including a vector of plot names of the form of `plots = c("name of plot 1", "name of plot 2", ...))`. Again, any of the individual plots listed in the previous section that are available for the model type can be included in the vector. Some examples of user specified panels are included below.

```{r}
# Creates a panel with a user specified vector of two plot names
resid_interact(tree_model, plots = c("resid", "qq"))

# Creates a panel from a vector of four plot names
resid_interact(tree_model, plots = c("hist", "ls", "cookd", "lev"))
```

## Package Specified Panels {#interact_pre}

`resid_interact` offers the same four prespecified panels as `resid_panel`:

- [`all`](#interact_all)
- [`default`](#interact_default)
- [`R`](#interact_R)
- [`SAS`](#interact_SAS)

These can be used by including the option of `plots = "specified panel name"`. As with `resid_panel`, the options of `all`, `default`, and `SAS` can be used for all model types, but the option of `R` can only be used for models of type “lm” or “glm”. The details of these panels and examples of the code are included below.

#### Panel of All Plots {#interact_all}

The option of `plots = "all"` creates an interactive version of the [panel of all](#all) plots included in the package that are available for the model type input into `resid_interact`.

```{r}
# Creates an interactive panel of all plots available for an "lm" model
resid_interact(tree_model, plots = "all")
```

#### Default Panel {#interact_default}

The option of `plots = "default"` creates an interactive version of the [default panel](#default) of plots. That is, this is the panel that is created if no `plots` option is specified in `resid_interact`.

```{r}
# Creates an interactive default panel with the option explicitly specified
resid_interact(tree_model, plots = "default")
```

#### Base R Inspired Panel of Plots {#interact_R}

The option of `plots = "R"` creates an interactive version of the [R panel](#R) of plots. This option can only be used with an "lm" or "glm" model.

```{r}
# Creates an interactive version of the R panel of plots with the smoother option for the residual plot set to TRUE
resid_interact(tree_model, plots = "R", smoother = TRUE)
```

#### SAS Inspired Panel of Plots {#interact_SAS}

The option of `plots = "SAS"` creates an interactive version of the [SAS panel](#SAS). 

```{r}
# Creates an interactive version of the SAS panel of plots
resid_interact(tree_model, plots = "SAS")
```

## Residual Types

`resid_interact` includes the option of `type` to specify the type of residual to use in the plot. This option works in the same way as the `type` option in `resid_panel`. See the section on [residual types](#type) in `resid_panel` for details on how to use this option and the available residual types for each of the model options.

```{r}
# Example requesting the default interactive panel with Pearson residuals from an lm model
resid_interact(tree_model, type = "pearson")
```

## Formatting Options

`resid_interact` has the same formatting options as all of the functions in ggResidpanel. 

- `axis.text.size` and `title.text.size`
- `nrow`
- `scale`
- `theme`
- `title.opt`

See the section on [formatting options](#format) under the `resid_panel` documentation for the details on how to use the formatting options.

# <span style="color:blue">`resid_xpanel`</span> {#resid_xpanel}

# <span style="color:blue">`resid_compare`</span> {#resid_compare}

# <span style="color:blue">`resid_auxpanel`</span> {#resid_auxpanel}
